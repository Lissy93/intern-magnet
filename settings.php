<?php$pn =7;$page_restrictions = "loggedin"; // (notloggedin || loggedin || any)// Start session and include files, if not already doneif(session_id() == '') { session_start(); }include_once $_SERVER['DOCUMENT_ROOT']."/php/Db.class.php";         // Database Classinclude_once $_SERVER['DOCUMENT_ROOT']."/php/UserActions.class.php";// User Actions Class$ua = new UserActions();$loggedIn = $ua->isLoggedIn();if($loggedIn){    $userObj = $ua->makeUserObject();    if(!$userObj){$loggedIn = false;}}// This page should only be viewed by users who are registered and logged inif(!$loggedIn){ header('Location: login.php'); }$social = $userObj->getSocialMedia();$information = $userObj->getAdditionalInformation();//Skills$skillsObj = new Skills();$usersSkills = $skillsObj->getUsersSkills($userObj->getUserId());$userHasSkills = false;if(count($usersSkills)>1){    $userHasSkills = true;}else if(count($usersSkills>0)){    if(count($usersSkills)==1){        if($usersSkills[0]!="" && $usersSkills[0]!=null  && $usersSkills[0]!=" "){            $userHasSkills = true;        }        else{            $userHasSkills = true;        }    }}/* Categories */$categories = $ua->getCategories();$employerCategories = $userObj->getEmployersCategories();/* Profile Completness */$profileCompleteness =  $userObj->calculateProfileCompleteness();$tips = $userObj->getProfileImprovementTips();if($profileCompleteness<=20){ $c = "danger";        $m = "Urgent Attention Needed"; }else if($profileCompleteness<=40){ $c = "warning";  $m = "Attention Needed"; }else if($profileCompleteness<=70){ $c = "info";     $m = "Getting there";}else if($profileCompleteness>70) { $c = "success";  $m = "Your profiles looking great!";}/* Magnet Requets */$magnetObj = new Magnet();$magRequestsSent     = count($magnetObj->getOutwardConnections($userObj->getUserId()));$magRequestsReceived = count($magnetObj->getInwardConnections($userObj->getUserId()));$magMatches          = count($magnetObj->getTwoWayConnections($userObj->getUserId()));?><!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <meta charset="utf-8">    <meta http-equiv="X-UA-Compatible" content="IE=edge">    <meta name="viewport" content="width=device-width, initial-scale=1">    <meta name="description" content="">    <meta name="author" content="Alicia Sykes">    <link rel="shortcut icon" href="img/favicon.ico">    <title>Settings</title>    <!-- Bootstrap -->    <link href="css/bootstrap.min.css" rel="stylesheet">    <!-- Fonts -->    <link href='http://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>    <!-- Custom styles for template -->    <link href="css/login-styles.css" rel="stylesheet">    <link href="css/styles.css" rel="stylesheet">    <link rel="stylesheet" href="/lib/fancybox/jquery.fancybox.css" type="text/css" media="screen" />    <!-- Fancybox helpers -->    <link rel="stylesheet" href="/lib/fancybox/helpers/jquery.fancybox-buttons.css" type="text/css" media="screen" />    <link rel="stylesheet" href="/lib/fancybox/helpers/jquery.fancybox-thumbs.css" type="text/css" media="screen" />    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->    <!--[if lt IE 9]>    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>    <![endif]--></head><body><div class=" main container">    <?php require($_SERVER['DOCUMENT_ROOT'] . "/html/navbar.php"); ?>    <div class="inner-main">        <div class="row">           <?php if($profileCompleteness<81){?>            <div class="alert alert-<?php echo $c; ?>" role="alert" onclick="location.href='#awsome-profile'" id="profile-completeness-notice">                <?php echo $m." - profile is <b>".$profileCompleteness; ?>% complete</b>. <?php if(count($tips)>0){ ?>Click <a href="#awsome-profile">here</a> to see <b>(<?php echo count($tips);?>)</b> tips for improvement<?php } ?>            </div>            <?php } ?>            <h1>Settings | <?php echo $userObj->getFullName(); ?></h1></div>        <br />        <div class="row">            <div class="col-sm-4">                <div class="panel panel-default">                    <div class="panel-heading"><h3>About You</h3><i class="fa fa-link fa-1x"></i></div>                    <li class="list-group-item text-right">                        <span class="pull-left"><strong>User Type</strong></span>                        <i><?php echo $userObj->getUserType(); ?></i>                    </li>                    <?php if($userObj->getUserType()=='student'){ ?>					<li class="list-group-item text-right">                        <span class="pull-left"><strong>Year of Study</strong>- <i><?php echo $userObj->getFormatedYearOfStudy(); ?></i></span>                         <a class="iframlink" href="/html/change-year.php?iframe">Edit</a>                    </li>                    <?php } ?>                    <?php if($userObj->getUserType()=='student'){ ?>                    <li class="list-group-item text-right">                        <span class="pull-left"><strong>Category</strong> -  <i><?php echo $userObj->getUserCategory(); ?></i></span>                        <a title="Change your subject category" class="iframlink" href="/html/change-category.php?iframe">Change</a>                    </li>                    <?php } ?>                   <li class="list-group-item text-right">                            <span class="pull-left">                                 <?php if($userObj->getUserType()=='student'){ ?>                                    <strong>About You</strong>                                 <?php } else if($userObj->getUserType()=='employer'){ ?>                                     <strong>About Your Company</strong>                                <?php } ?>                            </span>                        <a class="iframlink" href="/html/edit-description.php?iframe">Edit</a>                    </li>                    <?php if($userObj->getUserType()=='student'){ ?>                    <li class="list-group-item text-right">                        <span class="pull-left">                            <strong>Upload CV</strong> -  <i><?php echo ($userObj->isCvUploaded() ? "Uploaded" : "Not yet uploaded"); ?></i>                        </span>                        <a href="/html/upload-cv.php?iframe" class="iframlink" title="Upload CV">Change</a>                    </li>                    <?php } else if($userObj->getUserType()=='employer'){ ?>                        <li class="list-group-item text-right">                        <span class="pull-left">                            <strong>Company Profile</strong> -  <i><?php echo ($userObj->isCvUploaded() ? "Uploaded" : "Not yet uploaded"); ?></i>                        </span>                            <a href="/html/upload-employerProfile.php?iframe" class="iframlink" title="Upload CV">Change</a>                        </li>                    <?php } ?>                    <?php if($userObj->getUserType()=='student'){ ?>                    <li class="list-group-item text-right">                        <span class="pull-left"><strong>Connect with LinkedIn</strong></span>                        <a class="iframlink" href="/html/connect-linkedin.php?iframe" onClick="alert('Coming Soon!')">Connect</a>                    </li>                    <?php } ?>                    <li class="list-group-item text-right" title="Are you currently looking for an internship?">                        <span class="pull-left"><strong>Searchable</strong> - <?php echo $userObj->getVisibility(); ?></span>                        <a class="iframlink" href="/html/change-visibility.php?iframe">Change</a>                    </li>                </div>            </div>            <div class="col-sm-4">                <div class="panel panel-default">                    <div class="panel-heading"><h3>Account Settings</h3><i class="fa fa-link fa-1x"></i></div>                    <ul class="list-group">                        <li class="list-group-item text-right">                            <span class="pull-left"><strong>                                    <a title="Change Password" class="iframlink" href="/html/change-password.php?iframe">Change Password</a>                                </strong>                            </span>*********                        </li>                        <li class="list-group-item text-right"><span class="pull-left"><strong>                                    <a title="Update Email Address" class="iframlink" href="/html/change-email.php?iframe">Update Email Address</a>                                </strong></span><?php echo $userObj->getEmailAddress(); ?></li>                        <li class="list-group-item text-right"><span class="pull-left"><strong>                                    <a title="Change Username" class="iframlink" href="/html/change-username.php?iframe">Change Username</a>                                </strong></span><?php echo $userObj->getUsername(); ?></li>                        <?php if($userObj->getUserType()=='student'){ ?>                        <li class="list-group-item text-right"><span class="pull-left"><strong>                                    <a title="Change First Name" class="iframlink" href="/html/update-firstName.php?iframe">Update First Name</a>                                </strong></span><?php echo $userObj->getFirstName(); ?></li>                        <?php } ?>                        <?php if($userObj->getUserType()=='student'){ ?>                        <li class="list-group-item text-right"><span class="pull-left"><strong>                                    <a title="Change Last Name" class="iframlink" href="/html/update-lastName.php?iframe">Update Last Name</a>                                </strong></span><?php echo $userObj->getLastName(); ?></li>                        <?php } else if($userObj->getUserType()=='employer'){ ?>                            <li class="list-group-item text-right"><span class="pull-left"><strong>                                        <a title="Update Company Name" class="iframlink" href="/html/update-companyName.php?iframe">Update Company Name</a>                                    </strong></span><?php echo $userObj->getCompanyName(); ?></li>                        <?php } ?>                       <li class="list-group-item text-right"><span class="pull-left"><strong>                                    <a title="Change Profile Picture" class="iframlink" href="/html/update-picture.php?iframe">Update Picture</a>                                </strong></span>-</li>                        <li class="list-group-item text-right"><span class="pull-left"><strong>                                    <a title="Delete Account" class="iframlink" href="/html/delete-account.php?iframe">Delete Account</a>                                </strong></span>-</li>                    </ul>                </div>            </div>            <div class="col-sm-4">                <div class="panel panel-default">                    <div class="panel-heading"><h3>Social Accounts</h3><i class="fa fa-link fa-1x"></i></div>                    <?php for($i = 0; $i< count($social); $i++){ ?>                        <li class="list-group-item text-right">                            <span class="pull-left"><strong>                                    <img src="/ico/sm_<?php echo $social[$i]['service']; ?>.png" class="small-ico"/>                                    <a href="<?php echo $social[$i]['url']; ?>"><?php echo $social[$i]['service']; ?></a>                                </strong>                            </span>                            <a class="iframlink" href="/html/social-network-remove.php?iframe&id=<?php echo $social[$i]['id']?>">Remove</a></li>                    <?php } ?>                    <?php if(count($social)==0){ ?>                        <li class="list-group-item"><strong>                                You haven't yet added any social networks to your profile yet,                                <a class="iframlink" href="/html/social-network-add.php?iframe">click here</a> to get started                            </strong> </li>                    <?php } ?>                    <li class="list-group-item text-right"><span class="pull-left"><strong>                                <a class="iframlink" href="/html/social-network-add.php?iframe">Add New</a>                            </strong></span>-</li>                </div>            </div>        </div>        <div class="row">            <?php if($userObj->getUserType()=='student'){ ?>            <div class="col-sm-6">                <div class="panel panel-default">                    <div class="panel-heading"><h3>Skills</h3><i class="fa fa-link fa-1x"></i></div>                    <?php if(count($usersSkills)>0){ ?>                        <li class="list-group-item"><strong>                           <?php for($i = 0; $i<count($usersSkills); $i++){?>                                <span class="tag"><?php echo $usersSkills[$i]; ?></span>                            <?php } ?>                                <a class="iframlink" href="/html/add-skills.php?iframe"><span class="tag">Add New...</span></a>                            <br /><br /><br />                            </strong> </li>                    <?php } else { ?>                    <li class="list-group-item"><strong>                            You haven't yet added any Skills to your profile yet,                            <a class="iframlink" href="/html/add-skills.php?iframe">click here</a> to get started                        </strong> </li>                    <?php } ?>                    <li class="list-group-item text-right"><span class="pull-left"><strong>                                <a class="iframlink" href="/html/add-skills.php?iframe">Add New</a>                            </strong></span>-</li>                </div>            </div>            <?php } else if($userObj->getUserType()=='employer'){ ?>                <div class="col-sm-4">                    <div class="panel panel-default">                        <div class="panel-heading"><h3>Industry Categories</h3><i class="fa fa-link fa-1x"></i></div>                        <form action="/actions/update-employer-categories.php" method="post">                            <ul class="list-group">                                <?php for($i=0; $i<count($categories); $i++){ $checked = ""; ?>                                    <li class="list-group-item">                                        <?php                                        for($j=0; $j<count($employerCategories); $j++){                                            if ($employerCategories[$j]['category_id'] == $categories[$i]['id']){                                                $checked = "checked";                                            }                                        }                                        ?>                                        <input <?php echo $checked; ?> type="checkbox" value="<?php echo $categories[$i]['id']?>"                                                                       id="<?php echo $categories[$i]['id']?>"                                                                       class="small-checkbox"                                                                       name="interestedCategories[]"/>                                        <label for="<?php echo $categories[$i]['id']?>"><?php echo $categories[$i]['name']?></label>                                    </li>                                <?php } ?>                                <li class="list-group-item-success">                                    <button type="submit" class="simple-tb" style="width: 100%; height: 40px;">Update Categories</button>                                </li>                            </ul>                        </form>                    </div>                </div>                <div class="col-sm-8">                    <div class="panel panel-default">                        <div class="panel-heading"><h3>Important Information for Companies on Intern Magnet</h3><i class="fa fa-link fa-1x"></i></div>                        <div class="panel-body">                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut                                labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco                                laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in                                voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat                                non proident, sunt in culpa qui officia deserunt mollit anim id est laborum</p>                            <br />                            <p>                                Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium,                                totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae                                dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt.                            </p>                        </div>                    </div>                </div>            <?php } ?>            <?php if($userObj->getUserType()=='student'){ ?>            <div class="col-sm-6">                <div class="panel panel-default">                    <div class="panel-heading"><h3>Details</h3><i class="fa fa-link fa-1x"></i></div>                    <?php for($i=0; $i<count($information);$i++){?>                        <li class="list-group-item text-right" title="<?php echo $information[$i]['description']; ?>">                            <span class="pull-left"><strong>                                    <?php echo $information[$i]['type']; ?>                                </strong>-                                <i><?php echo $information[$i]['value']; ?></i>                            </span><a class="iframlink" href="/html/removeInfo.php?id=<?php echo $information[$i]['id']?>">Remove</a></li>                    <?php } ?>                    <li class="list-group-item text-right"><span class="pull-left"><strong>                                <a class="iframlink" href="/html/additional-information-add.php?iframe">Add New</a>                            </strong></span>-</li>                </div>            </div>            <?php } ?>       </div>    <div class="row">        <div class="col-md-6">            <div class="panel panel-default">                <div class="panel-heading"><h3>Profile Completeness</h3><i class="fa fa-link fa-1x"></i></div>                <div class="panel-inner" id="awsome-profile">                    <?php                    $profileCompleteness =  $userObj->calculateProfileCompleteness();                          $tips = $userObj->getProfileImprovementTips();                            if($profileCompleteness<=20){ $c = "danger";        $m = "Urgent Attention Needed"; }                            else if($profileCompleteness<=40){ $c = "warning";  $m = "Attention Needed"; }                            else if($profileCompleteness<=70){ $c = "info";     $m = "Getting there";}                            else if($profileCompleteness>70) { $c = "success";  $m = "Your profiles looking great!";}                    ?>                    <div class="alert alert-<?php echo $c; ?>" role="alert">                        <?php echo $m." - profile is ".$profileCompleteness; ?>% complete</p>                    </div>                    <?php if(count($tips)>0){ ?>                        <p><b>Tips for improving profile completeness:</b></p>                        <ol>                            <?php for($i = 0; $i < count($tips); $i++){ ?>                            <li><?php echo $tips[$i]; ?></li>                            <?php } ?>                        </ol>                    <?php } ?>                    <br />                    <div class="progress" style="height: 40px;">                        <div class="progress-bar progress-bar-<?php echo $c; ?> progress-bar-striped" role="progressbar"                             aria-valuenow="<?php echo $profileCompleteness; ?>" aria-valuemin="0" aria-valuemax="100"                             style="width: <?php echo $profileCompleteness; ?>%">                            <span><?php echo $profileCompleteness; ?>% Complete</span>                        </div>                    </div>                </div>            </div>        </div>        <div class="col-md-6">            <div class="panel panel-default">                <div class="panel-heading"><h3>Magnetising</h3><i class="fa fa-link fa-1x"></i></div>                <div class="panel-inner">                    <p>You have sent <b><?php echo $magRequestsSent;?></b> magnet requests in the past 30 days</p>                    <p>You have received <b><?php echo $magRequestsReceived;?></b> magnet requests in the past 30 days</p>                    <p>You have <b><?php echo $magMatches;?></b> magnet matches from the past 30 days</p>                    <a class="grey-button pull-right" href="/magnet-board.php" style="width: 100%;">View all Magnet Requests <span class="glyphicon glyphicon-chevron-right"></span></a>                    <br /><br /><br />                </div>            </div>        </div>    </div>    </div></div><?php require($_SERVER['DOCUMENT_ROOT'] . "/html/footer.php"); ?><!-- jQuery (necessary for Bootstrap's JavaScript plugins) --><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script><!-- Include all compiled plugins (below), or include individual files as needed --><script src="js/bootstrap.min.js"></script><script src="/js/notification-script.js"></script><script type="text/javascript" src="/lib/fancybox/jquery.fancybox.js"></script><script type="text/javascript" src="/lib/fancybox/helpers/jquery.fancybox-buttons.js"></script><script type="text/javascript" src="/lib/fancybox/helpers/jquery.fancybox-media.js"></script><script type="text/javascript" src="/lib/fancybox/helpers/jquery.fancybox-thumbs.js"></script><script>    $(document).ready(function() {        $("a.iframlink").fancybox({            'type':'iframe',            'width':500,            'centerOnScroll': true,            afterClose: function () {   parent.location.reload(true);   }        });    });</script></body></html>